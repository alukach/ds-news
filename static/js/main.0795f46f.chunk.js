(this["webpackJsonpds-news"]=this["webpackJsonpds-news"]||[]).push([[0],{141:function(e,t,n){e.exports=n(222)},146:function(e,t,n){},222:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(64),o=n.n(r),l=(n(146),n(23)),i=n(15),u=n(9),s=n(243),d=n(59),p=n(20),m=n(127),b=n.n(m),O=n(109),f=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||u.d,j=n(37),h=n(7),E=Object(h.createAsyncAction)("AUTH/FETCH_TOKEN_REQUEST","AUTH/FETCH_TOKEN_SUCCESS","AUTH/FETCH_TOKEN_FAILURE")(),v=Object(h.createAction)("AUTH/LOGOUT")(),y=Object(h.createReducer)("").handleType(Object(h.getType)(E.success),(function(e,t){return t.payload})).handleType(Object(h.getType)(v),(function(e){return""})),g=Object(u.c)({token:y}),A=n(103),R=Object(h.createAction)("QUERY/SET")(),S=Object(h.createAction)("QUERY/SET_SEARCH_TERM")(),N=Object(h.createAction)("QUERY/SET_SORT")(),T=Object(h.createAction)("QUERY/REPO_ADD")(),w=Object(h.createAction)("QUERY/REPO_RM")(),k=Object(h.createAsyncAction)("QUERY/SEARCH_REQUEST","QUERY/SEARCH_SUCCESS","QUERY/SEARCH_FAILURE")(),q=Object(h.createAction)("QUERY/START_POLLING")(),U=Object(h.createAction)("QUERY/STOP_POLLING")(),C=Object(h.createAction)("QUERY/SET_POLLING_TIMER")(),_=n(40),L=n.n(_),I={query:{search:"",repo:["now","how","ds-business","ds-team","operations","ds-realwork","labs"].map((function(e){return"developmentseed/".concat(e)})),sort:"created"},results:null,polling:{active:!0,count:null,interval:300}},H=Object(h.createReducer)(I.query).handleAction(S,(function(e,t){var n=t.payload;return Object(i.a)({},e,{search:n})})).handleAction(R,(function(e,t){var n=t.payload;return Object(i.a)({},e,{},n)})).handleAction(N,(function(e,t){var n=t.payload;return Object(i.a)({},e,{sort:n})})).handleAction(T,(function(e,t){var n=t.payload,a=e.repo,c=Object(A.a)(e,["repo"]);return Object(i.a)({},c,{repo:a.includes(n)?a:a.concat(n)})})).handleAction(w,(function(e,t){var n=t.payload,a=e.repo,c=Object(A.a)(e,["repo"]);return Object(i.a)({},c,{repo:a.filter((function(e){return e!==n}))})})),Q=Object(h.createReducer)(I.results).handleAction(k.request,(function(e,t){return{status:"FETCHING",data:null===e||void 0===e?void 0:e.data,error:void 0,asOf:L()().format("LLL")}})).handleAction(k.success,(function(e,t){return{status:"SUCCESS",data:t.payload,error:void 0,asOf:L()().format("LLL")}})).handleAction(k.failure,(function(e,t){return{status:"FAILED",data:void 0,error:t.payload,asOf:L()().format("LLL")}})),x=Object(h.createReducer)(I.polling).handleAction(q,(function(e){return Object(i.a)({},e,{active:!0})})).handleAction(U,(function(e){return Object(i.a)({},e,{count:null,active:!1})})).handleAction(C,(function(e,t){var n=t.payload;return Object(i.a)({},e,{count:n})})),F=Object(u.c)({query:H,results:Q,polling:x}),Y=n(102),D=n(241),M=n(16),G=n(72),P=n(226),B=n(56),z=n(44),J=n(231),K=n(232),W=[function(e,t,n){var a=n.ajax,c=n.config;return e.pipe(Object(P.a)(Object(h.isActionOf)(E.request)),Object(B.a)((function(e){var t=e.payload;return a.post(c.api.auth,{code:t},{"Content-Type":"application/json",Accept:"application/json"}).pipe(Object(z.a)((function(e){return e.response})),Object(z.a)((function(e){var t=e.access_token;return E.success(t)})),Object(J.a)((function(e){return Object(G.a)(E.failure(e))})))})))},function(e){return e.pipe(Object(P.a)(Object(h.isActionOf)(E.success)),Object(K.a)(Object(M.d)("/")))}],$=n(14),X=n(129),V=n(227),Z=n(247),ee=n(237),te=n(77),ne=n(233),ae=n(234),ce=n(235),re=n(236),oe=n(238),le=n(239),ie=n(240),ue=n(98),se=n(128),de=Object(se.a)([function(e){return e}],(function(e){return Object.entries(e).filter((function(e){var t=Object($.a)(e,2),n=(t[0],t[1]);return Array.isArray(n)?n.length:n})).flatMap((function(e){var t=Object($.a)(e,2),n=t[0],a=t[1];return Array.isArray(a)?a.map((function(e){return[n,e]})):[[n,a]]})).map((function(e){var t=Object($.a)(e,2),n=t[0],a=t[1];return"search"===n?a:"".concat(n,":").concat(a)})).join(" ")})),pe=n(26),me=function(e){var t=Object($.a)(e,2),n=t[0],a=t[1];return JSON.stringify(n.query.query)!==JSON.stringify(a.query.query)},be=[function(e,t,n){var a=n.config;return t.pipe(Object(ne.a)(),Object(P.a)(me),Object(ae.a)(a.searchDebounceMs),Object(z.a)((function(e){var t=Object($.a)(e,2);t[0];return t[1].query.query})),Object(z.a)((function(e){return Object(M.e)(Object(i.a)({},t.value.router.location,{search:"q=".concat(encodeURIComponent(de(e)))}))})))},function(e,t,n){var a=n.config;return e.pipe(Object(X.a)(M.b),Object(P.a)((function(e){return e.payload.location.pathname===a.paths.feed})),Object(P.a)((function(e){return e.payload.isFirstRendering})),Object(z.a)((function(){return R((e=t.value.router.location.search.slice(3),decodeURIComponent(e).split(" ").map((function(e){return e.split(":")})).reduce((function(e,t){return Object(i.a)({},e,{},1!==t.filter(Boolean).length&&["sort","repo"].includes(t[0])?Object(pe.a)({},t[0],(e[t[0]]||[]).concat(t.slice(1).join(":"))):{search:e.search?"".concat(e.search," ").concat(t.join(":")):t.join(":")})}),{})));var e})))},function(e,t,n){var a=n.config;return(Object(V.a)(e.pipe(Object(P.a)((function(e){return[Object(h.isActionOf)(E.success),function(e){return Object(h.isActionOf)(C)(e)&&0===e.payload}].some((function(t){return t(e)}))}))),t.pipe(Object(ne.a)(),Object(P.a)(me))).pipe(Object(ae.a)(a.searchDebounceMs),Object(P.a)((function(){return!!t.value.auth.token})),Object(z.a)((function(){return k.request(de(t.value.query.query))}))))},function(e,t,n){var a=n.github;n.ajax;return e.pipe(Object(P.a)(Object(h.isActionOf)(k.request)),Object(ue.a)((function(e){var n=e.payload;return Object(te.a)(a.query({query:n,token:t.value.auth.token})).pipe(Object(z.a)((function(e){return k.success(e)})),Object(J.a)((function(e){return Object(G.a)(k.failure(e))})))})))},function(e,t){return e.pipe(Object(X.a)(q),Object(re.a)(Object(ee.a)(0,1e3).pipe(Object(z.a)((function(e){return t.value.query.polling.interval-e})),Object(oe.a)((function(e){return e>=0})),Object(z.a)(C),Object(le.a)(),Object(ie.a)(e.pipe(Object(X.a)(U))))))},function(e,t){return e.pipe(Object(X.a)(d.a),Object(ce.a)(Object(Z.a)(Object(G.a)(k.request(de(t.value.query.query))).pipe(Object(P.a)((function(){return!!t.value.auth.token}))),Object(G.a)(q()).pipe(Object(P.a)((function(){return!!t.value.query.polling.active})),Object(P.a)((function(){return!!t.value.auth.token}))))))}],Oe=D.a.apply(void 0,Object(Y.a)(W).concat(Object(Y.a)(be))),fe=n(245),je=n(130),he=n.n(je),Ee=n(45),ve=n(131),ye=n(132),ge={github:new(function(){function e(){Object(Ee.a)(this,e)}return Object(ve.a)(e,[{key:"query",value:function(e){var t,n;return he.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.query,n=e.token,a.abrupt("return",Object(ye.graphql)("\n        query($searchQuery: String!) {\n          search(query: $searchQuery, type: ISSUE, first: 100) {\n            issueCount\n            nodes {\n              ... on Issue {\n                title\n                number\n                repository {\n                  owner {\n                    login\n                  }\n                  name\n                }\n                author {\n                  login\n                  avatarUrl\n                }\n                createdAt\n                closedAt\n                reactions(first: 100) {\n                  edges {\n                    node {\n                      content\n                    }\n                  }\n                }\n                comments {\n                  totalCount\n                }\n              }\n            }\n          }\n        }\n      ",{searchQuery:t,headers:{authorization:"Bearer ".concat(n)}}));case 2:case"end":return a.stop()}}))}}]),e}()),ajax:fe.a},Ae="https://5sy0eu5bsh.execute-api.us-west-2.amazonaws.com/dev";var Re="http://localhost:3000";var Se,Ne={clientId:"3f43f5bebd8452ebf262",domain:Re,searchDebounceMs:300,api:{auth:"".concat(Ae,"/auth")},paths:{feed:"/",login:"/login"}},Te=Object(p.a)(),we=Object(s.a)({dependencies:Object(i.a)({},ge,{config:Ne})}),ke=[we,Object(O.a)(Te)],qe=f(u.a.apply(void 0,ke)),Ue={key:"root",storage:b.a,whitelist:["auth"]},Ce=Object(d.b)(Ue,(Se=Te,Object(u.c)({router:Object(j.b)(Se),auth:g,query:F}))),_e=Object(u.e)(Ce,{},qe),Le=Object(d.c)(_e);we.run(Oe);var Ie=n(134),He=Object(l.c)((function(e){return{isLoggedIn:!!e.auth.token}}),(function(e){return Object(u.b)({dispatchLogout:v},e)}))((function(e){var t=e.isLoggedIn,n=e.dispatchLogout;return c.a.createElement("nav",{id:"header",className:"navbar"},c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("img",{className:"logo",src:"".concat("/ds-news","/favicon.png"),alt:"ds news logo"}),c.a.createElement("h1",null,"ds news")),c.a.createElement("li",null,c.a.createElement("a",{className:"selected",href:Ne.paths.feed},"feed"))),c.a.createElement("ul",null,c.a.createElement("li",null,t?c.a.createElement("button",{onClick:n,className:"link-button"},"logout"):c.a.createElement("a",{href:"https://github.com/login/oauth/authorize?client_id=".concat(Ne.clientId,"&redirect_uri=").concat(Ne.domain,"/").concat(Ne.paths.login,"&scope=repo")},"Login with Github"))))})),Qe=n(140),xe=n(18),Fe=n(135),Ye=n.n(Fe),De=Object(l.c)((function(e){return{token:e.auth.token}}),(function(e){return Object(u.b)({dispatchfetchToken:E.request},e)}))((function(e){var t=e.location,n=e.dispatchfetchToken,r=e.token,o=Ye.a.parse(t.search).code,l=Array.isArray(o)?o[0]:o;return Object(a.useEffect)((function(){l&&n(l)}),[l,n]),o?r?c.a.createElement(xe.a,{to:"/"}):c.a.createElement("p",null,"Fetching auth token... ",r):c.a.createElement("p",{className:"error"},"No code provided. Please login.")})),Me=n(101),Ge={CONFUSED:":confused:",EYES:":eyes:",HEART:":heart:",HOORAY:":tada:",LAUGH:":smile:",ROCKET:":rocket:",THUMBS_DOWN:":-1:",THUMBS_UP:":+1:"},Pe=function(e){var t,n,a=e.title,r=e.number,o=e.author,l=e.createdAt,u=e.closedAt,s=e.repository,d=e.reactions,p=e.comments;return c.a.createElement("li",{className:u?"closed":""},c.a.createElement("h6",{className:"mb-0"},c.a.createElement("a",{href:"https://github.com/".concat(null===s||void 0===s?void 0:s.owner.login,"/").concat(null===s||void 0===s?void 0:s.name,"/issues/").concat(r)},a)),c.a.createElement("p",null,c.a.createElement("a",{href:"https://github.com/".concat(null===s||void 0===s?void 0:s.owner.login,"/").concat(null===s||void 0===s?void 0:s.name,"/issues/").concat(r)},c.a.createElement("strong",null,null===s||void 0===s?void 0:s.name),"#",r)," by ",c.a.createElement("a",{href:"https://github.com/".concat(null===o||void 0===o?void 0:o.login)},null===o||void 0===o?void 0:o.login)," ",c.a.createElement("span",{title:l},L()(l).fromNow()),u&&c.a.createElement("em",{className:"small",title:u}," ","(closed ",L()(u).fromNow(),")")," | ",(null===(t=d.edges)||void 0===t?void 0:t.length)?Object.entries((null===d||void 0===d?void 0:null===(n=d.edges)||void 0===n?void 0:n.reduce((function(e,t){return Object(i.a)({},e,Object(pe.a)({},(null===t||void 0===t?void 0:t.node.content)||"",(e[(null===t||void 0===t?void 0:t.node.content)||""]||0)+1))}),{}))||{}).slice().sort((function(e,t){var n=Object($.a)(e,1)[0];return Object($.a)(t,1)[0]>n?-1:1})).map((function(e){var t=Object($.a)(e,2),n=t[0],a=t[1];return c.a.createElement("span",{key:n},c.a.createElement(Me.a,{emoji:Ge[n],size:16,tooltip:!0}),a>1&&c.a.createElement("sup",null,a))})):c.a.createElement("em",{className:"small"},"no reactions")," | ",c.a.createElement("span",null,p.totalCount?c.a.createElement(c.a.Fragment,null,c.a.createElement(Me.a,{emoji:"speech_balloon",size:16,tooltip:!0}),c.a.createElement("sup",null,100===p.totalCount?"100+":p.totalCount)):c.a.createElement("em",{className:"small"},"no comments"))))},Be=function(e){var t=e.query.repo,n=e.results,r=e.dispatchAddRepo,o=e.dispatchRmRepo,l=Object(a.useState)(""),i=Object($.a)(l,2),u=i[0],s=i[1];return c.a.createElement("ul",{className:"col-sm-3 list-unstyled sidebar"},c.a.createElement("li",{className:"mt-2 "},c.a.createElement("h4",null,"last updated"),c.a.createElement("span",{className:"text-monospace small"},n&&("FETCHING"===n.status?"loading...":"".concat(n.asOf.toLowerCase())))),c.a.createElement("li",null,c.a.createElement("h4",null,"Repos"),c.a.createElement("ul",{className:"list-unstyled"},t.slice().sort().map((function(e,t){return c.a.createElement("li",{key:t,className:"overflow-auto text-nowrap"},c.a.createElement("span",{className:"ml-1 close-link",title:"remove repo",onClick:function(){return o(e)}}),c.a.createElement("pre",{className:"ml-1 d-inline"},e))}))),c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),r(u),s("")}},c.a.createElement("input",{type:"text",placeholder:"owner/repo",className:"small text-monospace w-100 pl-1 mt-2",value:u,onChange:function(e){return s(e.currentTarget.value)}}))))},ze=n(246),Je=n(244),Ke=n(248),We=n(242),$e=function(e){var t=e.sort,n=e.setSort,a=e.searchTerm,r=e.setSearchTerm,o={created:"recently created",updated:"recently updated",interactions:"interactions","reactions-heart":"loved","reactions-tada":"celebrated",reactions:"reactions","reactions-+1":"liked","reactions--1":"disliked"};return c.a.createElement("nav",{className:"navbar px-1"},c.a.createElement("ul",{className:"d-flex",style:{flexGrow:1}},c.a.createElement("li",{className:"w-100"},c.a.createElement("input",{placeholder:"Search",value:a,className:"text-monospace w-100",onChange:function(e){return r(e.currentTarget.value)}}))),c.a.createElement("ul",{className:"ml-auto"},c.a.createElement("li",{className:"ml-2"},c.a.createElement(ze.a,{className:"d-inline"},c.a.createElement(Je.a,{tag:"a",className:"link-button d-inline-block"},"most ",o[t]," \u25bc")," ",c.a.createElement(Ke.a,null,Object.entries(o).map((function(e){var t=Object($.a)(e,2),a=t[0],r=t[1];return c.a.createElement(We.a,{key:a,onClick:function(){return n(a)}},r)})))))))},Xe=Object(l.c)((function(e){var t=e.query;return{query:t.query,results:t.results,polling:t.polling}}),(function(e){return Object(u.b)({dispatchSetSearchTerm:S,dispatchSetSort:N,dispatchAddRepo:T,dispatchRmRepo:w},e)}))((function(e){var t,n=e.results,a=e.query,r=e.dispatchSetSort,o=e.dispatchSetSearchTerm,l=e.dispatchAddRepo,i=e.dispatchRmRepo;return c.a.createElement("div",{className:"row no-gutters"},c.a.createElement("div",{className:"col-sm pr-1"},c.a.createElement($e,{sort:a.sort,setSort:r,searchTerm:a.search,setSearchTerm:o}),"FAILED"===(null===n||void 0===n?void 0:n.status)?c.a.createElement("pre",null,n.error):(null===n||void 0===n?void 0:n.data)&&c.a.createElement("ol",{className:"issues"},null===(t=n.data.search.nodes)||void 0===t?void 0:t.filter((function(e){return 0!==Object.entries(e).length})).map((function(e,t){return c.a.createElement(Pe,Object.assign({key:t},e))}))),c.a.createElement("code",null,de(a))),c.a.createElement(Be,{query:a,results:n,dispatchAddRepo:l,dispatchRmRepo:i}))})),Ve=function(){return c.a.createElement(l.a,{store:_e},c.a.createElement(j.a,{history:Te},c.a.createElement(Ie.a,{persistor:Le,loading:c.a.createElement("p",null,"Loading...")},c.a.createElement(Qe.a,null,c.a.createElement(He,null),c.a.createElement("div",{className:"container-fluid"},c.a.createElement(xe.d,null,c.a.createElement(xe.b,{path:Ne.paths.login,component:De}),c.a.createElement(xe.b,{path:Ne.paths.feed,component:Xe})))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(Ve,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[141,1,2]]]);
//# sourceMappingURL=main.0795f46f.chunk.js.map